
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass{article}

    
    
    \usepackage{graphicx} % Used to insert images
    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{color} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    

    
    
    \definecolor{orange}{cmyk}{0,0.4,0.8,0.2}
    \definecolor{darkorange}{rgb}{.71,0.21,0.01}
    \definecolor{darkgreen}{rgb}{.12,.54,.11}
    \definecolor{myteal}{rgb}{.26, .44, .56}
    \definecolor{gray}{gray}{0.45}
    \definecolor{lightgray}{gray}{.95}
    \definecolor{mediumgray}{gray}{.8}
    \definecolor{inputbackground}{rgb}{.95, .95, .85}
    \definecolor{outputbackground}{rgb}{.95, .95, .95}
    \definecolor{traceback}{rgb}{1, .95, .95}
    % ansi colors
    \definecolor{red}{rgb}{.6,0,0}
    \definecolor{green}{rgb}{0,.65,0}
    \definecolor{brown}{rgb}{0.6,0.6,0}
    \definecolor{blue}{rgb}{0,.145,.698}
    \definecolor{purple}{rgb}{.698,.145,.698}
    \definecolor{cyan}{rgb}{0,.698,.698}
    \definecolor{lightgray}{gray}{0.5}
    
    % bright ansi colors
    \definecolor{darkgray}{gray}{0.25}
    \definecolor{lightred}{rgb}{1.0,0.39,0.28}
    \definecolor{lightgreen}{rgb}{0.48,0.99,0.0}
    \definecolor{lightblue}{rgb}{0.53,0.81,0.92}
    \definecolor{lightpurple}{rgb}{0.87,0.63,0.87}
    \definecolor{lightcyan}{rgb}{0.5,1.0,0.83}
    
    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{hotHandEffect}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=blue,
      linkcolor=darkorange,
      citecolor=darkgreen,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    

    \section{Investigation of ``Hot-hand effect''}


    There is a widely held belief in basketball that some players have
periods of time where they are much better shooters than normal. This
can be called having a ``hot hand''. An example would be if a player hit
3 shots in a row, then many fans would expect that player to be more
likely (than their usual percentage) to hit their next shot.

Whether this is a real effect or some kind of cognitive bias has been
previously studied. For instance in 1984(83?, 85? FIX THIS),
{[}RESEARCHERS{]} looked at actual shooting results of the Philadelphia
76ers, free throws of the Boston Celtics, and controlled-experiment
shots of college students. Their data did not support the existence of a
hot-hand effect. This question has been revisited, for instance in
{[}PAPERS FROM 2005?? or so??{]} which also failed to find evidence to
support the existence of the hot-hand effect. Interestingly, in 2015
{[}RESEARCHERS{]} noted that the sampling method used in previous
studies was flawed. The flaw is subtle, but leads to some evidence for
the hot-hand effect.

My intent is to investigate recent shooting results of NBA players with
the goals of:

Looking for evidence to support (or reject) the existence of the
hot-hand effect.

Understand the subtleties of the sampling flaw found by
{[}RESEARCHERS{]}.


    \subsection{Getting the data}


    The reason I chose to study NBA data was that I found a resource that
makes shooting data easy to download for the NBA: www.nbasavant.com. I
have downloaded all shooting data for 2016-2017 and placed it in the
files nba\_savant\_\_.csv in the data/nba\_savant folder. {[}Note: you
can ostensibly download a .csv file of the shots data for the entire
year, but the files seem to be limited to 50,000 lines which is not
enough. That's why I split the data by month when downloading.{]}

There is some concern about the complete validity of the data. My
biggest concern is the data for April 2017 seems to be incomplete. There
are not near enough total shots for the month and spot checking some
players shows many fewer shots than expected for that player. However,
working with this data will at least provide a framework for studying
similar datasets.

Before reading in the data, we will load pandas, a python library used
for data analysis.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
\end{Verbatim}

    Now, we can read in the data from the downloaded .csv files and store
the data as a DataFrame (a pandas data structure).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{glob}
        \PY{n}{files\PYZus{}to\PYZus{}read} \PY{o}{=} \PY{n}{glob}\PY{o}{.}\PY{n}{glob}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../data/nba\PYZus{}savant/*.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{shots} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{f}\PY{p}{)} \PY{k}{for} \PY{n}{f} \PY{o+ow}{in} \PY{n}{files\PYZus{}to\PYZus{}read}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    We can look at the first few rows of data to get a sense of what data we
have (and if the read did what we expected it to do):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{shots}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:}              name           team\_name   game\_date  season  espn\_player\_id  \textbackslash{}
        0  Andre Drummond     Detroit Pistons  2017-01-01    2016          6585.0   
        1    Nerlens Noel  Philadelphia 76ers  2017-01-30    2016       2991280.0   
        2       Jon Leuer     Detroit Pistons  2017-01-01    2016          6452.0   
        3   Dwight Howard       Atlanta Hawks  2017-01-29    2016          2384.0   
        4  Andre Drummond     Detroit Pistons  2017-01-01    2016          6585.0   
        
              team\_id  espn\_game\_id  period  minutes\_remaining  seconds\_remaining  \textbackslash{}
        0  1610612765     400899381       4                  5                 57   
        1  1610612755             0       3                  7                 18   
        2  1610612765     400899381       1                  3                 29   
        3  1610612737     400900132       4                  0                 45   
        4  1610612765     400899381       1                  7                 57   
        
              \ldots           shot\_type shot\_distance          opponent  x  y  dribbles  \textbackslash{}
        0     \ldots      2PT Field Goal             0        Miami Heat  0  1         0   
        1     \ldots      2PT Field Goal             0  Sacramento Kings  0  1         0   
        2     \ldots      2PT Field Goal             0        Miami Heat  0  1         0   
        3     \ldots      2PT Field Goal             0   New York Knicks  0  1         0   
        4     \ldots      2PT Field Goal             0        Miami Heat  0  1         0   
        
           touch\_time  defender\_name  defender\_distance  shot\_clock  
        0         0.0            NaN                0.0         0.0  
        1         0.0            NaN                0.0         0.0  
        2         0.0            NaN                0.0         0.0  
        3         0.0            NaN                0.0         0.0  
        4         0.0            NaN                0.0         0.0  
        
        [5 rows x 22 columns]
\end{Verbatim}
        
    Each row of the DataFrame consists of one shot (the observation) and 22
variables. Those variables are the columns. Note that the \ldots{}
indicates we are not seeing all of the columns. Pandas has a setting
that gives the maximum number of columns to print. It appears that value
defaults to 20. We can increase this value and then look at the first
few rows again (using new max of 60, but 22 would suffice).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{display.max\PYZus{}columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{60}\PY{p}{)}
        \PY{n}{shots}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}              name           team\_name   game\_date  season  espn\_player\_id  \textbackslash{}
        0  Andre Drummond     Detroit Pistons  2017-01-01    2016          6585.0   
        1    Nerlens Noel  Philadelphia 76ers  2017-01-30    2016       2991280.0   
        2       Jon Leuer     Detroit Pistons  2017-01-01    2016          6452.0   
        3   Dwight Howard       Atlanta Hawks  2017-01-29    2016          2384.0   
        4  Andre Drummond     Detroit Pistons  2017-01-01    2016          6585.0   
        
              team\_id  espn\_game\_id  period  minutes\_remaining  seconds\_remaining  \textbackslash{}
        0  1610612765     400899381       4                  5                 57   
        1  1610612755             0       3                  7                 18   
        2  1610612765     400899381       1                  3                 29   
        3  1610612737     400900132       4                  0                 45   
        4  1610612765     400899381       1                  7                 57   
        
           shot\_made\_flag          action\_type       shot\_type  shot\_distance  \textbackslash{}
        0               1  Alley Oop Dunk Shot  2PT Field Goal              0   
        1               1  Alley Oop Dunk Shot  2PT Field Goal              0   
        2               0  Alley Oop Dunk Shot  2PT Field Goal              0   
        3               1  Alley Oop Dunk Shot  2PT Field Goal              0   
        4               1  Alley Oop Dunk Shot  2PT Field Goal              0   
        
                   opponent  x  y  dribbles  touch\_time  defender\_name  \textbackslash{}
        0        Miami Heat  0  1         0         0.0            NaN   
        1  Sacramento Kings  0  1         0         0.0            NaN   
        2        Miami Heat  0  1         0         0.0            NaN   
        3   New York Knicks  0  1         0         0.0            NaN   
        4        Miami Heat  0  1         0         0.0            NaN   
        
           defender\_distance  shot\_clock  
        0                0.0         0.0  
        1                0.0         0.0  
        2                0.0         0.0  
        3                0.0         0.0  
        4                0.0         0.0  
\end{Verbatim}
        

    \subsection{Strategy}


    For an initial investigation, I plan on making the following
assumptions:

Each player's shots are to be investigated as one sequence throughout
the entire year. A different, and perhaps more useful, choice would be
to split up each players shots by game. We will look at the data split
by game later.

To consider the existence of the hot-hand effect we will only look at
whether the previous shot was a make or miss. The literature standard
seems to be looking at shooting percentages after streaks of 1, 2, or 3
consecutive makes or misses. We will handle more complicated scenarios
later.

The only variables we will consider for analyzing each shot are those
that determine:

Which player took the shot (name, espn\_player\_id)

When the shot was taken (game\_date, period, minutes\_remaining,
seconds\_remaining) {[}Note: these are used to determine the order the
shots occurred in.{]}

Whether the shot was a make or miss (shot\_made\_flag)

We will not, at least initially, be considering other variables such as
those associated to shot difficulty, opponents, or effects of other
players shooting on a given night.


    \subsection{Rearranging the data}


    Let's start by removing columns we are not interested in. Actually, we
are only keeping the columns we are interested in.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{shots} \PY{o}{=} \PY{n}{shots}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{period}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{minutes\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seconds\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{shots}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}              name   game\_date  espn\_player\_id  period  minutes\_remaining  \textbackslash{}
        0  Andre Drummond  2017-01-01          6585.0       4                  5   
        1    Nerlens Noel  2017-01-30       2991280.0       3                  7   
        2       Jon Leuer  2017-01-01          6452.0       1                  3   
        3   Dwight Howard  2017-01-29          2384.0       4                  0   
        4  Andre Drummond  2017-01-01          6585.0       1                  7   
        
           seconds\_remaining  shot\_made\_flag  
        0                 57               1  
        1                 18               1  
        2                 29               0  
        3                 45               1  
        4                 57               1  
\end{Verbatim}
        
    Now we can sort the dataframe by player and date/time. That will help us
to easily find the previous shot for each player.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{shots} \PY{o}{=} \PY{n}{shots}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{period}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{minutes\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seconds\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{False}\PY{p}{,}\PY{n+nb+bp}{False}\PY{p}{]}\PY{p}{)}
        \PY{n}{shots}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:}                     name   game\_date  espn\_player\_id  period  \textbackslash{}
        4544   Metta World Peace  2016-10-30            25.0       1   
        189    Metta World Peace  2016-10-30            25.0       1   
        15320  Metta World Peace  2016-11-08            25.0       4   
        28798  Metta World Peace  2016-11-08            25.0       4   
        33601  Metta World Peace  2016-11-23            25.0       1   
        
               minutes\_remaining  seconds\_remaining  shot\_made\_flag  
        4544                   2                 38               0  
        189                    1                  6               0  
        15320                  6                 24               0  
        28798                  5                 39               0  
        33601                  7                 39               1  
\end{Verbatim}
        
    Now we add a boolean variable to indicate if the previous shot was a
make or miss.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{p}{(}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{shots\PYZus{}only\PYZus{}previous} \PY{o}{=} \PY{n}{shots}\PY{p}{[}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    We can now calculate the shooting percentage for each player both after
a make and after a miss.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{player\PYZus{}shot\PYZus{}df} \PY{o}{=} \PY{n}{shots\PYZus{}only\PYZus{}previous}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{aggregate}\PY{p}{(}\PY{p}{[}\PY{n}{numpy}\PY{o}{.}\PY{n}{mean}\PY{p}{,}\PY{n}{numpy}\PY{o}{.}\PY{n}{sum}\PY{p}{,} \PY{n}{size}\PY{p}{]}\PY{p}{)}
        \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}                                        shot\_made\_flag          
                                                         mean  sum size
        espn\_player\_id previous\_shot\_made\_flag                         
        25.0           0                             0.285714    6   21
                       1                             0.000000    0    6
        136.0          0                             0.380435  105  276
                       1                             0.412429   73  177
        165.0          0                             0.430435  198  460
\end{Verbatim}
        
    Adding columns for easier access of percentage after miss and make.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}
        \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}shots}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:}                         shot\_made\_flag                                        \textbackslash{}
                                          mean              sum          size          
        previous\_shot\_made\_flag              0         1      0      1      0      1   
        espn\_player\_id                                                                 
        25.0                          0.285714  0.000000    6.0    0.0   21.0    6.0   
        136.0                         0.380435  0.412429  105.0   73.0  276.0  177.0   
        165.0                         0.430435  0.386997  198.0  125.0  460.0  323.0   
        272.0                         0.385593  0.386667   91.0   58.0  236.0  150.0   
        558.0                         0.285714  0.500000    2.0    3.0    7.0    6.0   
        
                                percent\_after\_miss percent\_after\_make num\_shots  
                                                                                 
        previous\_shot\_made\_flag                                                  
        espn\_player\_id                                                           
        25.0                              0.285714           0.000000      27.0  
        136.0                             0.380435           0.412429     453.0  
        165.0                             0.430435           0.386997     783.0  
        272.0                             0.385593           0.386667     386.0  
        558.0                             0.285714           0.500000      13.0  
\end{Verbatim}
        
    We now have the shooting percentage for every player both after a miss
and after a make. If shooters do not get ``hot'', then it seems
reasonable that for each player that percent\_after\_miss and
percent\_after\_make should be roughly equal. If shooters do get
``hot'', then it seems reasonable that for each player that
percent\_after\_miss should typically be less than percent\_after\_make.


    \subsection{Analyzing the data}


    To start investigating these questions we can first plot the data in a
scatter plot. Points will be plotted with red points for a player that
has a higher percentage after a make and blue points for a player that
has a higher percentage after a miss.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{colors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scatter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{colors}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7fa29ef95110>
\end{Verbatim}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{hotHandEffect_files/hotHandEffect_27_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The previous scatter plot does not seem to allow us to defnitively
conclude much of anything. Players seem roughly split between those that
shoot better after a miss and those that shoot better after a make.

We can run statistical tests to evaluate the results objectively.

The first test we will try is a t-test. Our null hypothesis will be that
shooting percentage after a make and shooting percentage after a miss
are the same. The alternative hypothesis will be that shooting
percentage after a make is greater than shooting percentage after a
miss. Let's assume an alpha value of 0.05 which means that we need a
p-value less than 0.05 to reject the null hypothesis and conclude the
data support that players have a better shooting percentage after a
make. Note that this results in a one-tailed test. Annoyingly, python's
standard libraries seem to only compute p-values for a two-tailed test.
That means we need to divide the python calculated p-value by 2 and then
possibly subtracting from 1 (depending on whether the t-statistic is
positive or negative) to get our true p-value.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k+kn}{import} \PY{n+nn}{scipy.stats}
         
         \PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{p}\PY{p}{)} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{ttest\PYZus{}1samp}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{nan\PYZus{}policy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{omit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{if} \PY{n}{t} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} t\PYZgt{}0 implies percent\PYZus{}after\PYZus{}make is generally greater than percent\PYZus{}after\PYZus{}miss}
             \PY{c+c1}{\PYZsh{} so this is the tail that (at least somewhat) supports our alternative hypothesis}
             \PY{n}{p} \PY{o}{=} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
         \PY{k}{else}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} t\PYZlt{}0 implies percent\PYZus{}after\PYZus{}make is generally less than percent\PYZus{}after\PYZus{}miss}
             \PY{c+c1}{\PYZsh{} so this is the tail that definitely does not support our alternative hypothesis}
             \PY{n}{p} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
         \PY{n}{p}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} 0.99951561688842283
\end{Verbatim}
        
    So, our p-value is (much) larger than 0.05 which means the data do not
support the hot hand hypothesis. In fact, the data would have supported
the hypothesis that the average shooting percentage of players is higher
after a miss than after a make.

This p-value feels suspiciously high. Maybe we should check with some
random data. We can fill in the shot\_made\_flag column with random
values of 0 or 1 and see what the result is. If everything is set up
correctly, then we should get an average p-value of 0.5. Note that this
implies that we will want to rerun a p-value calculation multiple times,
so we should create a function.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{def} \PY{n+nf}{calculatePValueForShootingPercentageAfterMake}\PY{p}{(}\PY{n}{shots}\PY{p}{)}\PY{p}{:}
             \PY{n}{shots} \PY{o}{=} \PY{n}{shots}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{period}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{minutes\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seconds\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{False}\PY{p}{,}\PY{n+nb+bp}{False}\PY{p}{]}\PY{p}{)}
             \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{p}{(}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{shots\PYZus{}only\PYZus{}previous} \PY{o}{=} \PY{n}{shots}\PY{p}{[}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{player\PYZus{}shot\PYZus{}df} \PY{o}{=} \PY{n}{shots\PYZus{}only\PYZus{}previous}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{aggregate}\PY{p}{(}\PY{p}{[}\PY{n}{numpy}\PY{o}{.}\PY{n}{mean}\PY{p}{,}\PY{n}{numpy}\PY{o}{.}\PY{n}{sum}\PY{p}{,}\PY{n}{size}\PY{p}{]}\PY{p}{)}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
             
             \PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{p}\PY{p}{)} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{ttest\PYZus{}1samp}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{nan\PYZus{}policy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{omit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{if} \PY{n}{t} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} t\PYZgt{}0 implies percent\PYZus{}after\PYZus{}make is generally greater than percent\PYZus{}after\PYZus{}miss}
                 \PY{c+c1}{\PYZsh{} so this is the tail that (at least somewhat) supports our alternative hypothesis}
                 \PY{n}{p} \PY{o}{=} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{else}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} t\PYZlt{}0 implies percent\PYZus{}after\PYZus{}make is generally less than percent\PYZus{}after\PYZus{}miss}
                 \PY{c+c1}{\PYZsh{} so this is the tail that definitely does not support our alternative hypothesis}
                 \PY{n}{p} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{return} \PY{n}{p}
         
         \PY{n}{calculatePValueForShootingPercentageAfterMake}\PY{p}{(}\PY{n}{shots}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} 0.99951561688842283
\end{Verbatim}
        
    Now, lets run the function on some random values and see if we get
p-values spread around 0.5 or not.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{shotsCopy} \PY{o}{=} \PY{n}{shots}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
             \PY{n}{shotsCopy}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{k}{print}\PY{p}{(}\PY{n}{calculatePValueForShootingPercentageAfterMake}\PY{p}{(}\PY{n}{shotsCopy}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0.993998416438
0.999887160399
0.975065026248
0.966410361609
0.999990883012
0.999689085421
0.996097249856
0.99927941521
0.999199689557
0.983316491484
0.707874807672
0.980682535743
0.999842953492
0.849032693898
0.996173041446
0.981494862753
0.994025035981
0.990291912163
0.984775743732
0.998937696847
    \end{Verbatim}

    Those results suggest something is wrong in our calculations. All of the
p-values from random data were greater than 0.91.

It turns out that Miller and Sanjurjo published a paper in 2015
explaining where our previous calculations went wrong. Suprisingly, from
random data the expected value of the observed percentage after a make
is lower than the expected value of the observed percentage after a
miss. In fact, if there were n total shots, then the expected difference
in the observed shooting percentages after a make and a miss is 1/(n-1).

We can adjust our function for calculating p-values accordingly.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{k}{def} \PY{n+nf}{calculatePValueForShootingPercentageAfterMake}\PY{p}{(}\PY{n}{shots}\PY{p}{)}\PY{p}{:}
             \PY{n}{shots} \PY{o}{=} \PY{n}{shots}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{period}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{minutes\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seconds\PYZus{}remaining}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{False}\PY{p}{,}\PY{n+nb+bp}{False}\PY{p}{]}\PY{p}{)}
             \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{shots\PYZus{}only\PYZus{}previous} \PY{o}{=} \PY{n}{shots}\PY{p}{[}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{player\PYZus{}shot\PYZus{}df} \PY{o}{=} \PY{n}{shots\PYZus{}only\PYZus{}previous}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{aggregate}\PY{p}{(}\PY{p}{[}\PY{n}{numpy}\PY{o}{.}\PY{n}{mean}\PY{p}{,}\PY{n}{numpy}\PY{o}{.}\PY{n}{sum}\PY{p}{,}\PY{n}{size}\PY{p}{]}\PY{p}{)}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}shots}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             
             \PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{p}\PY{p}{)} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{ttest\PYZus{}1samp}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}shots}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{nan\PYZus{}policy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{omit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{if} \PY{n}{t} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} t\PYZgt{}0 implies percent\PYZus{}after\PYZus{}make is generally greater than percent\PYZus{}after\PYZus{}miss}
                 \PY{c+c1}{\PYZsh{} so this is the tail that (at least somewhat) supports our alternative hypothesis}
                 \PY{n}{p} \PY{o}{=} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{else}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} t\PYZlt{}0 implies percent\PYZus{}after\PYZus{}make is generally less than percent\PYZus{}after\PYZus{}miss}
                 \PY{c+c1}{\PYZsh{} so this is the tail that definitely does not support our alternative hypothesis}
                 \PY{n}{p} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{return} \PY{n}{p}
         
         \PY{n}{calculatePValueForShootingPercentageAfterMake}\PY{p}{(}\PY{n}{shots}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:} 0.75880592310433004
\end{Verbatim}
        
    The new function gives a p-value of 0.7588 which is larger than 0.05, so
we still fail to conclude that NBA players' shooting percentages go up
after a make.

Let's validate the new funciton against random data. Again, we expect
p-values to be spread around 0.5.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{pValues} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{numOver5} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{shotsCopy} \PY{o}{=} \PY{n}{shots}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
             \PY{n}{shotsCopy}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{p} \PY{o}{=} \PY{n}{calculatePValueForShootingPercentageAfterMake}\PY{p}{(}\PY{n}{shotsCopy}\PY{p}{)}
             \PY{n}{pValues}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{p}\PY{p}{)}
             \PY{k}{if} \PY{n}{p}\PY{o}{\PYZgt{}}\PY{l+m+mf}{0.5}\PY{p}{:}
                 \PY{n}{numOver5} \PY{o}{=} \PY{n}{numOver5} \PY{o}{+} \PY{l+m+mi}{1}
             \PY{k}{print}\PY{p}{(}\PY{n}{p}\PY{p}{)}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{average p\PYZhy{}value: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{numpy}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pValues}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{number of p\PYZhy{}values over 0.5: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{numOver5}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0.875257808726
0.772559923487
0.50194759835
0.37662715207
0.565453222083
0.781052263528
0.601739882434
0.47048500954
0.45414149071
0.571537449916
0.501563061241
0.21255842209
0.221183417865
0.743536950574
0.757962110158
0.233545882647
0.953646272994
0.891953866312
0.257968487117
0.842954865031
0.543924146845
0.782133347607
0.646086756681
0.178751250802
0.0691381752039
0.515724426283
0.555238994945
0.840529770619
0.372220903577
0.667119784643
0.820249589045
0.655800947025
0.145627917143
0.246183530871
0.365313577008
0.463325590125
0.376940195083
0.790411346798
0.764942280871
0.594369723271
0.319527190788
0.71493153237
0.355313093464
0.119370800614
0.897473976511
0.529501345876
0.0756433174557
0.19307675874
0.771434737089
0.976185525554
average p-value: 0.538683313396
number of p-values over 0.5: 30
    \end{Verbatim}

    Our p-value calculation is validated by random data since we get an
average p-value near 0.5 and roughly half of the p-values over 0.5.

    Where to go from here? There are a number of things we could tidy up.
Some of these include the following.

Each player's shots are viewed as one sequence for the entire year. We
could split each player's shots on a per game basis.

The t-test assumes that the distribution of differences between percent
after make and miss is normally distributed. We could look into the
validity of that assumption.

There seem to be a fair number of outliers in the scatter plot. It seems
likely that a lot of the outliers are players that took very few shots.
One option to deal with the outliers would be to only consider players
that took at least a certain number of shots. That seems tempting at
first, but once we split each players shots into individual games we
will need to consider relatively small numbers of shots anyway.
Hopefully, we can use appropriate statistics to account for a player
with a small number of shots. The essential problem we have is that we
are using something roughly akin to an average-of-averages which is
problematic with each inner average having a different sample size.

We can extend our analysis to look at more than the previous shot. Maybe
the previous n shots for some n=2 or n=3.

We could account for the different shot types. Maybe do something like
only looking at 3-point shots or jump shots.

We could apply machine learning (or other) techniques to look for
patterns in the players that do have a better shooting percentage after
a make or a miss.


    \subsection{Splitting shots on a per game basis}


    In principal we should be able to use almost the same procedure as when
we split on player only. We just need to group by both the player and
the game.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{shots\PYZus{}only\PYZus{}previous}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:}                     name   game\_date  espn\_player\_id  period  \textbackslash{}
         189    Metta World Peace  2016-10-30            25.0       1   
         15320  Metta World Peace  2016-11-08            25.0       4   
         28798  Metta World Peace  2016-11-08            25.0       4   
         33601  Metta World Peace  2016-11-23            25.0       1   
         23045  Metta World Peace  2016-11-23            25.0       1   
         
                minutes\_remaining  seconds\_remaining  shot\_made\_flag  \textbackslash{}
         189                    1                  6               0   
         15320                  6                 24               0   
         28798                  5                 39               0   
         33601                  7                 39               1   
         23045                  4                 21               0   
         
                previous\_shot\_made\_flag  
         189                          0  
         15320                        0  
         28798                        0  
         33601                        0  
         23045                        1  
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{player\PYZus{}shot\PYZus{}df} \PY{o}{=} \PY{n}{shots\PYZus{}only\PYZus{}previous}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{previous\PYZus{}shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{aggregate}\PY{p}{(}\PY{p}{[}\PY{n}{numpy}\PY{o}{.}\PY{n}{mean}\PY{p}{,}\PY{n}{numpy}\PY{o}{.}\PY{n}{sum}\PY{p}{]}\PY{p}{)}
         \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:}                                                   shot\_made\_flag    
                                                                     mean sum
         espn\_player\_id game\_date  previous\_shot\_made\_flag                   
         25.0           2016-10-30 0                                  0.0   0
                        2016-11-08 0                                  0.0   0
                        2016-11-23 0                                  1.0   2
                                   1                                  0.0   0
                        2016-11-29 0                                  0.2   1
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{)}
         \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shot\PYZus{}made\PYZus{}flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:}                           shot\_made\_flag                percent\_after\_miss  \textbackslash{}
                                             mean       sum                           
         previous\_shot\_made\_flag                0    1    0    1                      
         espn\_player\_id game\_date                                                     
         25.0           2016-10-30            0.0  NaN  0.0  NaN                0.0   
                        2016-11-08            0.0  NaN  0.0  NaN                0.0   
                        2016-11-23            1.0  0.0  2.0  0.0                1.0   
                        2016-11-29            0.2  NaN  1.0  NaN                0.2   
                        2016-12-02            NaN  0.0  NaN  0.0                NaN   
         
                                   percent\_after\_make  
                                                       
         previous\_shot\_made\_flag                       
         espn\_player\_id game\_date                      
         25.0           2016-10-30                NaN  
                        2016-11-08                NaN  
                        2016-11-23                0.0  
                        2016-11-29                NaN  
                        2016-12-02                0.0  
\end{Verbatim}
        
    That worked, but it took a long time to evaluate. This is certainly a
candidate to find a more efficient method.

    There is also some concern that we are throwing away too much of our
data. Consider the player with espn\_player\_id of 25. The splitting by
game results in 3 games where the player had a miss and a make before
their last shot. However, we can look at all that player's shots.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{shots}\PY{p}{[}\PY{n}{shots}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{espn\PYZus{}player\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{25}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{game\PYZus{}date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} game\_date
         2016-10-30    2
         2016-11-08    2
         2016-11-23    4
         2016-11-29    5
         2016-12-02    1
         2016-12-05    5
         2016-12-07    1
         2016-12-22    1
         2017-01-06    1
         2017-01-14    2
         2017-02-06    3
         2017-03-13    1
         dtype: int64
\end{Verbatim}
        
    We see the player had shots in 12 games, but we are only looking at 3 of
those games. This is likely worth looking at later, but we will ignore
this issue for now with the logic that players not taking many shots are
not what we are really interested in anyway.

    We can get a summary of the data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{player\PYZus{}shot\PYZus{}df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:}       shot\_made\_flag              
                         mean           sum
         count   39552.000000  39552.000000
         mean        0.444909      2.070060
         std         0.297917      1.769325
         min         0.000000      0.000000
         25\%         0.250000      1.000000
         50\%         0.500000      2.000000
         75\%         0.625000      3.000000
         max         1.000000     13.000000
\end{Verbatim}
        
    Note that the average percentage after a miss (0.538879) is greater than
the average percentage after a make (0.367874).

We can also plot the data using a scatter plot as before. Again blue
dots indicate higher percentage after a miss and red dots indicate
higher percentage after a make.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{colors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}miss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{percent\PYZus{}after\PYZus{}make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scatter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{colors}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7fa294dfb110>
\end{Verbatim}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{hotHandEffect_files/hotHandEffect_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We can also do the t-test again.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{p}\PY{p}{)} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{stats}\PY{o}{.}\PY{n}{ttest\PYZus{}1samp}\PY{p}{(}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{percent\PYZus{}after\PYZus{}make}\PY{o}{\PYZhy{}}\PY{n}{player\PYZus{}shot\PYZus{}df\PYZus{}unstack}\PY{o}{.}\PY{n}{percent\PYZus{}after\PYZus{}miss}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{nan\PYZus{}policy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{omit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{if} \PY{n}{t} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} t\PYZgt{}0 implies percent\PYZus{}after\PYZus{}make is generally greater than percent\PYZus{}after\PYZus{}miss}
             \PY{c+c1}{\PYZsh{} so this is the tail that (at least somewhat) supports our alternative hypothesis}
             \PY{n}{p} \PY{o}{=} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
         \PY{k}{else}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} t\PYZlt{}0 implies percent\PYZus{}after\PYZus{}make is generally less than percent\PYZus{}after\PYZus{}miss}
             \PY{c+c1}{\PYZsh{} so this is the tail that definitely does not support our alternative hypothesis}
             \PY{n}{p} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{p}\PY{o}{/}\PY{l+m+mi}{2}
         \PY{n}{p}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} 1.0
\end{Verbatim}
        
    Our p-value is very close to 1. Again, we cannot conclude that players
are more likely to make a shot after making the previous shot. In fact,
it seems very likely players are more likely to miss a shot after making
the previous shot.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{}shots[\PYZsq{}shot\PYZus{}made\PYZus{}flag\PYZsq{}] = np.random.randint(0,2,size=shots[\PYZsq{}shot\PYZus{}made\PYZus{}flag\PYZsq{}].count())}
         \PY{c+c1}{\PYZsh{}shots[:10]}
         \PY{c+c1}{\PYZsh{}df = shots[[\PYZsq{}shot\PYZus{}made\PYZus{}flag\PYZsq{},\PYZsq{}period\PYZsq{}]].groupby([\PYZsq{}shot\PYZus{}made\PYZus{}flag\PYZsq{}]).agg(\PYZsq{}count\PYZsq{})}
         \PY{c+c1}{\PYZsh{}df.head()}
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
